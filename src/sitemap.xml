<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
{%
  posts_table = {}
  for p in posts() do
    table.insert(posts_table, p)
  end

  table.sort(posts_table, orderPosts)

  function replace(str, old, new)
    return (str:gsub(old, new))
  end
%}

  {% for i in ipairs(posts_table) do %}
  <url>
    <loc>https://blog.facteer.com{{ string.sub(posts_table[i].url, 2) }}</loc>
    <lastmod>{{ replace(split(posts_table[i].last_modified, " ")[1], "/", "-") }}</lastmod>
    <changefreq>weekly</changefreq>
    <priority>1</priority>
  </url>
  {% end %}
</urlset>
